# Лабораторная работа 2
## Цель работы: 
1) Написать плохой докер файл
2) Исправить ошибки и написать хороший докер файл
## Ход работы: 
1) Необходимо написать плохой докер файл (Dockerfile).
2) Теперь стоит объяснить в чем он плох. 
* Ну во-первых, нельзя использовать latest тег, так как после этого мы не можем гарантировать поведение файла, так как версия базового образа может измениться. 
* Во-вторых, нет очистки кэша, что приведет к увеличению размера образа.
* В-третьих, мы использовали копирование всех файлов без необходимости, что увеличает размер.
* В-четвертых, мы использовали root-пользователя, тем самым страдает безопасность файла, так как мошенники смогут получить доступ.
  
  ![b3d65b5aede3a6aecc02252f4cbe6f19](https://github.com/user-attachments/assets/221f2312-c563-4c86-93a8-4de70dc446b1)

3) Нужно создать на основе ошибок хороший докер файл (Dockerfile.horoshi).
4) Ну не будет отходить от традиции и объясним чем он хорош.
* Во-первых, мы прописали фиксированную версию базового образа, в данном случае 24.04. Тем самым мы делаем действия докер файла предсказуемыми для нас.
* Во-вторых, с помощью команды ```apt-get clean``` и ```rm -rf /var/lib/apt/lists/*``` мы удаляем кэш, что уменьшает размер образа.
* В-третьих, мы оптимизировали файл тем, что копируем только необходимые файлы, а не все.
* В-четвертых, использовали определенного пользователя, а не root, что повышает безопасность файла.
  
  ![aced20a851f087e4dc2690a97fa63c07](https://github.com/user-attachments/assets/91ab7ad4-e735-4731-b1db-94a137d9b8c3)

5) Но даже с ~~плохим~~ хорошим докер файлом все равно можно загубить свою работу. Стоит обратить свое внимание на плохие практики работы с контейнерами. Разберем 2 практики.
* Например: мы решили использовать общие томы без должной изоляции. В этом случае возможен конфликт данных, а также проблемы с безопасностью. Т е если несколько контейнеров имеет доступ к одной директории. Команда: ```docker run -v app_data:/app/data my_image```.
* Иногда мы хотим сделать как лучше, а получается как всегда. Это относится к привилегированным доступам. Часто запускают контейнеры с флагом ```--privileged```. В таком случае открывается доступ ко всем устройствам хоста. Необходимо запускать только с минимальным набором прав, тогда эту ошибку можно избежать. Пример флагов: ```--cap-drop``` и ```--cap-add```.
## Вывод:
В итоге лабораторной работы мы разобрали как выглядят плохие докер файлы, как можно исправить ошибки, как написать хороший докер файл, как даже с хорошим докер файлом можно ошибаться в управлении контейнерами.
  
